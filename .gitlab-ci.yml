variables:
  IMAGE_TAG: $CI_REGISTRY_IMAGE:$CI_COMMIT_REF_NAME

lint:
  stage: test
  image: golang:1.16.3
  services:
    - docker:dind
  script:
      # Download required protos.
    - cd /
    - git clone https://github.com/googleapis/api-common-protos.git
      # Return back to original directory.
    - cd /builds/cards-against-humanity/cards-proto
    - go get -u github.com/googleapis/api-linter/cmd/api-linter
    - go get -u github.com/golang/protobuf/protoc-gen-go
    - api-linter --proto-path=/api-common-protos crusty_cards_api/cardpack_service.proto crusty_cards_api/game_service.proto crusty_cards_api/model.proto crusty_cards_api/user_service.proto
