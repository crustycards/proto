syntax = "proto3";

import "google/api/field_behavior.proto";
import "google/protobuf/timestamp.proto";

message User {
  // An opaque id unique to each user.
  // These are generated by the
  // server, never set by an api caller.
  //
  // Required when updating to indicate which
  // user should be updated.
  string id = 1;

  // The display name of the user.
  //
  // Required when creating.
  // Allowed when updating.
  string name = 2;

  // When the user was created.
  google.protobuf.Timestamp create_time = 3 [(google.api.field_behavior) = OUTPUT_ONLY];
}

// Configuration settings used to create a game.
message GameConfig {
  // The displayed name of the game.
  // Does not have to be unique among all
  // games since each game has a unique game_id.
  string game_name = 1;

  // The maximum number of players that can be in the game at once.
  // Artificial players do not count towards this limit.
  // Value must be at least 3 and at most 100.
  int32 max_players = 2;

  // The condition through which
  // a game will automatically end.
  oneof end_condition {
    // Once a player reaches this score, the game
    // is stopped automatically and that player is
    // marked as the winner.
    int32 max_score = 3;

    // The game never ends automatically.
    // Scores are still tracked.
    bool endless_mode = 4;
  }

  // The hand limit of each player.
  int32 hand_size = 5;

  // A list of cardpacks that should be used when making the game.
  // All cards from all cardpacks listed will be pulled from
  // the main api at game creation.
  repeated string cardpack_ids = 6;
}

// A singleton resource belonging to a user that contains user-specific settings.
// Exactly one exists for every user, and are created automatically whenever a user is created.
// All values are unset for new users and can only be changed by calling UpdateUserSettings.
message UserSettings {
  // Color schemes the frontend supports.
  enum ColorScheme {
    // Default color scheme.
    DEFAULT_LIGHT = 0;

    // Dark mode.
    DEFAULT_DARK = 1;
  }

  // The color scheme to show for the user.
  ColorScheme color_scheme = 1;

  // Default game settings for a user to quickly start a game.
  GameConfig quick_start_config = 2;
}

message Cardpack {
  // An opaque id unique to each cardpack.
  // These are generated by the
  // server, never set by an api caller.
  //
  // Required when updating to indicate which
  // cardpack should be updated.
  string id = 1;

  // The display name of the cardpack.
  //
  // Required when creating.
  // Allowed when updating.
  string name = 2;

  // The owner of the cardpack.
  // This user has full access to add, modify, or delete any cards in the pack.
  //
  // Required when creating (only user_id field is required).
  // Not allowed when updating.
  User owner = 3;

  // When the cardpack was created.
  google.protobuf.Timestamp create_time = 4 [(google.api.field_behavior) = OUTPUT_ONLY];

  // This field is reset anytime any changes are made to the cardpack including adding, modifying
  // and deleting cards as well as renaming the cardpack.
  google.protobuf.Timestamp update_time = 5 [(google.api.field_behavior) = OUTPUT_ONLY];

  // If this field is not empty, it indicates that the cardpack has been deleted. Cardpacks that
  // have been deleted are guaranteed to remain available to be undeleted for at least 30 days.
  google.protobuf.Timestamp delete_time = 6 [(google.api.field_behavior) = OUTPUT_ONLY];

  // How many other users liked this cardpack.
  int64 like_count = 7 [(google.api.field_behavior) = OUTPUT_ONLY];
}

message BlackCard {
  // An opaque id unique to each black card.
  // These are generated by the
  // server, never set by an api caller.
  //
  // Required when updating to indicate which
  // card should be updated.
  string id = 1;

  // The contents of the card.
  //
  // Required when creating.
  // Allowed when updating.
  string text = 2;

  // The number of white cards that should be played when this card is used.
  // Value must be 1, 2, or 3.
  //
  // Required when creating.
  // Allowed when updating.
  int32 answer_fields = 3;

  // The cardpack this card belongs to.
  //
  // Required when creating.
  // Not allowed when updating.
  string cardpack_id = 4;
}

message WhiteCard {
  // An opaque id unique to each black card.
  // These are generated by the
  // server, never set by an api caller.
  //
  // Required when updating to indicate which
  // card should be updated.
  string id = 1;

  // The contents of the card.
  //
  // Required when creating.
  // Allowed when updating.
  string text = 2;

  // The cardpack this card belongs to.
  //
  // Required when creating.
  // Not allowed when updating.
  string cardpack_id = 3;
}